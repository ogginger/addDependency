define("parseValidation",[],function(){return[function(e){if("string"!=typeof e.Options)throw{message:"Error: The input type was not string."};if(null==e.Options.match(/^.*define\(.*\);\s*$/gim))throw{message:"Error: Module does not contain a valid define statement."};if(null==e.Options.match(/^.*define\(.*({.*}|function\s*\(.*\)\s*{.*})\s*\);\s*$/gim))throw{message:"Error: The define statement has no content."};return!0},function(e){if(JSON.stringify(_.difference(["Header","Name","Dependencies","Exports","Content"],Object.keys(e.Object)))!=JSON.stringify([]))throw{message:"Error: The context was not a valid module."};return!0}]}),define("parse",["validate","parseValidation"],function(e,t){return function(n){var s=this;e({Validation:t,Data:{Options:n,Object:s}});var i=new RegExp(/^([\s\S]*)define\((.*)\);\s*$/i).exec(n);s.Header=i[1];var r=new RegExp(/^\s*('.+'|".+")?,?\s*(\[[\s\S]*\])?,?\s*(function\([\s\S]*\)\s*{[\s\S]*}|{[\s\S]*})\s*$/i).exec(i[2]).splice(1).filter(function(e){return Boolean(e)});if(1==r.length)s.Content=r[0];else if(2==r.length)if(s.Content=r[1],r[0].match(/^\s*('.+'|".+")\s*$/))s.Name=r[0].replace(/'|"/g,"");else{if(!r[0].match(/^\[[\s\S]*\]$/))throw{message:"The first argument of the define statement was not valid."};s.Dependencies=JSON.parse(r[0].replace(/'|"/g,'"')),r[1].match(/^function\(([\s\S]+)\)\s*{[\s\S]*}$/i)&&(s.Exports=new RegExp(/^function\(([\s\S]+)\)\s*{[\s\S]*}$/i).exec(r[1])[1].split(",").map(function(e){return new RegExp(/^\s*(\S+)\s*$/).exec(e)[1]}))}else{if(3!=r.length)throw{message:"Error: Invalid number of define arguments."};s.Name=r[0].replace(/'|"/g,""),s.Dependencies=JSON.parse(r[1].replace(/'|"/g,'"')),s.Content=r[2],r[2].match(/^function\(([\s\S]+)\)\s*{[\s\S]*}$/i)&&(s.Exports=new RegExp(/^function\(([\s\S]+)\)\s*{[\s\S]*}$/i).exec(r[2])[1].split(",").map(function(e){return new RegExp(/^\s*(\S+)\s*$/).exec(e)[1]}))}return s}}),define("composeValidation",["underscore"],function(e){return[function(t){if(t.Options&&"object"!=typeof t.Options)throw{message:"Error: The input is not of type object."};if(t.Options&&JSON.stringify(e.difference(Object.keys(t.Options),["Header","Name","Dependencies","Exports","Content"]))!=JSON.stringify([]))throw{message:"Error: The input is invalid."};return!0},function(t){if(JSON.stringify(e.difference(["Header","Name","Dependencies","Exports","Content"],Object.keys(t.Object)))!=JSON.stringify([]))throw{message:"Error: The state of the module was invalid."};if("string"!=typeof t.Object.Content)throw{message:"Error: The state content is not valid."};if(t.Object.Name&&"string"!=typeof t.Object.Name)throw{message:"Error: The state name is not of type string."};if(t.Object.Dependencies&&0==Array.isArray(t.Object.Dependencies))throw{message:"Error: The state dependencies is not of type array."};if(t.Object.Exports&&0==Array.isArray(t.Object.Exports))throw{message:"Error: The state exports is not of type array."};if(t.Object.Exports&&null==t.Object.Content.match(/^function\([\s\S]*\)\s*{[\s\S]*}$/i))throw{message:"Error: State has exports but content is not of type function."};return!0}]}),define("compose",["validate","composeValidation"],function(e,t){return function(n){var s=this,i="";return e({Data:{Object:s,Options:n},Validation:t}),Object.assign(s,n),s.Header&&(i=s.Header),i+="define(",s.Content&&(s.Name&&(i+='"'+s.Name+'", '),s.Dependencies&&(i+=JSON.stringify(s.Dependencies)+", "),s.Exports&&s.Content.match(/^function\([\s\S]*\)\s*{[\s\S]*}$/i)?(i+="function(",s.Exports.forEach(function(e,t){i+=e,s.Exports.length>1&&t!=s.Exports.length-1&&(i+=",")}),i+=") "+new RegExp(/^function\([\s\S]*\)\s*({[\s\S]*})$/i).exec(s.Content)[1]):i+=s.Content),i+=");"}}),define("Module",["parse","compose"],function(e,t){return function(){return{Header:void 0,Name:void 0,Dependencies:void 0,Exports:void 0,Content:void 0,parse:e,compose:t}}}),define("addDependency",["promise","Module","file"],function(e,t,n){return function(s){return e(function(e,i){n.get(s.FileName).then(function(e){return n.update({Name:s.FileName,Body:t().parse(e).compose({Dependencies:s.Dependency,Exports:s.Export})})}).then(function(){e(!0)}).catch(function(e){i(e)})})}});